# MPPI-with-reachability

## Run an experiment

Experiments should be able to be run via `run_experiments.py`.

This script loads all the relevant data, sets up the dynamics/map/controller objects, and then loops over (potentially) different trials and controller configurations, calling `run_trial.py` which actually executes the simulated experiment.

It then saves an experiment data object as a `.pkl` file to the `/results` directory.

## Plot an experiment

Experiment results can be plotted via `plot_example.py`, which loads the data for an experiment and then calls the plotting routine in `plot_traj_with_brt.py`. Most importantly, you can set which experiment file to plot!

## Interface descriptions

The experiment themselves rely on a single data file: the BRT file. This is generated by [`matlab/export_3d_brt_with_gradient.m`](matlab/export_3d_brt_with_gradient.m), which is hopefully fairly self-explanatory. It contains:

- the BRT value function
- the BRT value gradient with respect to theta (used to compute the optimal control)
- the grid axes over which the BRT value was calculated
- the BRT 'initial value,' i.e. the SDF of the obstacles (commonly `data0` in helperOC; this is used to compute whether the system has crashed into an obstacle)

The MATLAB routine which creates and saves this file does a few manipulations specific to this system to save some effort on the Python side; for example, I pad the borders of the X & Y dimensions of the state space with obstacle, and I duplicate the theta=0 slice of the value function to the end at theta=pi to handle theta's periodicity. 

Additionally, my set of experiments relies on some state pairs stored in [a JSON file](config_data/dubin_environment_state_pairs.json). This is simply a dictionary where `init` and `goal` are keys which each point to a list of state vectors.
